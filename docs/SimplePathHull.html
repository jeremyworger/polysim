<!DOCTYPE html>

<html>
<head>
  <title>Convex Hull for Simple Polygons</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
  <link rel="stylesheet" href="gh-fork-ribbon.css" />
</head>
<body>
  <div id="container">
    <div class="github-fork-ribbon-wrapper left-bottom">
        <div class="github-fork-ribbon">
            <a href="https://github.com/mkacz91/PolylineSimplification">Fork me on GitHub</a>
        </div>
    </div>
    <div id="background"></div>

      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">


                <a class="source" href="GUI.html">
                  GUI.pde
                </a>


                <a class="source" href="Line.html">
                  Line.pde
                </a>


                <a class="source" href="LineFitter.html">
                  LineFitter.pde
                </a>


                <a class="source" href="Math.html">
                  Math.pde
                </a>


                <a class="source" href="Path.html">
                  Path.pde
                </a>


                <a class="source" href="PathSimplifier.html">
                  PathSimplifier.pde
                </a>


                <a class="source" href="../index.html">
                  PolylineSimplification.pde
                </a>


                <a class="source" href="SimplePathHull.html">
                  SimplePathHull.pde
                </a>

            </div>
          </div>
        </li>
      </ul>

    <ul class="sections">



        <li id="section-1">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="convex-hull-for-simple-polygons">Convex Hull for Simple Polygons</h1>

            </div>

        </li>


        <li id="section-2">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>The <em>Convex Hull Problem</em> for arbitrary point set is known not to be solvalbe
under O(<em>n</em> log<em>n</em>) time. Nevertheless, if we know that the points make up
non intersecting polygonal path, linear time online solutions exist, as
reported by <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.512.9681"><strong>Melkman â€˜87</strong></a>.</p>

            </div>

        </li>


        <li id="section-3">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="simplepathhull-class">SimplePathHull Class</h2>

            </div>

        </li>


        <li id="section-4">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Performs online computation of convex hull for non intersecting polygonal
paths. The provided result is in a form of doubly linked list of points
arranged in CCW order. Uses Melkman algorithm with minor tweaks.</p>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimplePathHull</span> </span>{</pre></div></div>

        </li>


        <li id="section-5">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Node of the doubly linked list that describes the convex hull polygon.
Holds the hull point position and provides acces to the next and previous
nodes in CCW order.</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>{</pre></div></div>

        </li>


        <li id="section-6">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Position of the point</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">private</span> PVector pos;</pre></div></div>

        </li>


        <li id="section-7">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Gets the position of the point</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> PVector <span class="hljs-title">pos</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> pos;
    }</pre></div></div>

        </li>


        <li id="section-8">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Previous node in CCW order</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">private</span> Node prev;</pre></div></div>

        </li>


        <li id="section-9">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Gets the previous node in CCW order, or <code>null</code> if this node no longer
belongs to hull</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">prev</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> prev;
    }</pre></div></div>

        </li>


        <li id="section-10">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Next hull node in CCW order</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">private</span> Node next;</pre></div></div>

        </li>


        <li id="section-11">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Gets the next hull node in CCW order, or <code>null</code> if this node no longer
belongs to hull</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> next;
    }</pre></div></div>

        </li>


        <li id="section-12">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Creates a hull node with given position and neighbours. Automatically
alters the pointers of adjecent nodes.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Node</span><span class="hljs-params">(PVector pos, Node prev, Node next)</span> </span>{
      <span class="hljs-keyword">this</span>.pos = pos;
      <span class="hljs-keyword">this</span>.prev = prev;
      <span class="hljs-keyword">this</span>.next = next;
      prev.next = next.prev = <span class="hljs-keyword">this</span>;
    }</pre></div></div>

        </li>


        <li id="section-13">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Creates a hull node with given position, connected to itself</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Node</span><span class="hljs-params">(PVector pos)</span> </span>{
      <span class="hljs-keyword">this</span>.pos = pos;
      <span class="hljs-keyword">this</span>.prev = <span class="hljs-keyword">this</span>.next = <span class="hljs-keyword">this</span>;
    }</pre></div></div>

        </li>


        <li id="section-14">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>True if the node is part of a convex hull. A node that belongs to a hull,
may get removed from it when a more exterior point is added.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> next != <span class="hljs-keyword">null</span>;
    }</pre></div></div>

        </li>


        <li id="section-15">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Sets the adjecent node poinerts to null and returns the next node (as it
was before discarding). Does not modify the adjecent nodes.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">private</span> Node <span class="hljs-title">detach</span><span class="hljs-params">()</span> </span>{
      Node oldNext = next;
      prev = next = <span class="hljs-keyword">null</span>;
      <span class="hljs-keyword">return</span> oldNext;
    }
  }</pre></div></div>

        </li>


        <li id="section-16">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>First node of the convex hull</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">private</span> Node first;</pre></div></div>

        </li>


        <li id="section-17">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Gets the first node of the convex hull, or <code>null</code> if the hull is empty</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">first</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> first;
  }</pre></div></div>

        </li>


        <li id="section-18">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Number of points making up the hull</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> size;</pre></div></div>

        </li>


        <li id="section-19">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Gets the number of points making up the hull</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> size;
  }</pre></div></div>

        </li>


        <li id="section-20">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Returns true if the hull contains no points</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> size == <span class="hljs-number">0</span>;
  }</pre></div></div>

        </li>


        <li id="section-21">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Tries to extend the convex hull by given point. If the point lies outside
or on the current hull, it is accepted, becomes the new starting point and
the hull is adjusted to fit the extended point set. Otherwise the point is
ignored.
Returns the newly created node if the point was accepted, and <code>null</code>
otherwise.</p>

            </div>

            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">offer</span><span class="hljs-params">(PVector p)</span> </span>{
    <span class="hljs-keyword">if</span> (size &gt;= <span class="hljs-number">3</span>) {</pre></div></div>

        </li>


        <li id="section-22">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>In typical case with at least 3 hull points we seek tangents by skipping
all edges that become interior after adding <code>p</code> to the hull. Because
the offered points make up a non intersecting line, it suffices to
consider the viccinity of <code>first</code>.</p>

            </div>

            <div class="content"><div class='highlight'><pre>      Node n0 = first;
      <span class="hljs-keyword">while</span> (n0.prev != first &amp;&amp; Geometry.side(n0.pos, n0.prev.pos, p) &gt;= <span class="hljs-number">0</span>)
        n0 = n0.prev;
      Node n1 = first;
      <span class="hljs-keyword">while</span> (n1.next != first &amp;&amp; Geometry.side(n1.pos, n1.next.pos, p) &lt;= <span class="hljs-number">0</span>)
        n1 = n1.next;</pre></div></div>

        </li>


        <li id="section-23">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>If <code>n0</code> and <code>n1</code> diverged, i.e., any one left <code>first</code>, there were some
skipped edges, meaning the new point indeed is exterior to the current
hull. In that case, <code>n0p</code> and <code>n1p</code> form tangents and anything between
<code>n0</code> and <code>n1</code> must be removed from the hull.</p>

            </div>

            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (n0 != n1) {
        Node n = n0.next;
        <span class="hljs-keyword">while</span> (n != n1) {
          n = n.detach();
          --size;
        }
        first = <span class="hljs-keyword">new</span> Node(p, n0, n1);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (size == <span class="hljs-number">0</span>) {
      first = <span class="hljs-keyword">new</span> Node(p);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (size == <span class="hljs-number">1</span>) {
      first = <span class="hljs-keyword">new</span> Node(p, first, first);
    } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-24">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>We have two points and are about to create a triangle. Make sure it
is counter clockwise. If the triangle would become degenerated, we stick
to a 2-gon and simply detach <code>first</code>.</p>

            </div>

            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">float</span> s = Geometry.side(first.pos, first.next.pos, p);
      <span class="hljs-keyword">if</span> (s &lt; <span class="hljs-number">0</span>) {
        first = <span class="hljs-keyword">new</span> Node(p, first, first.next);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>) {
        first = <span class="hljs-keyword">new</span> Node(p, first.prev, first);
      } <span class="hljs-keyword">else</span> {
        first = <span class="hljs-keyword">new</span> Node(p, first.prev, first.detach());
        --size;
      }
    }

    <span class="hljs-keyword">if</span> (first.pos == p) {
      ++size;
      <span class="hljs-keyword">return</span> first;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
  }
}</pre></div></div>

        </li>

    </ul>
  </div>
</body>
</html>
